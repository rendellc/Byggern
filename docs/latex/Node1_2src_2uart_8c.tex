\hypertarget{Node1_2src_2uart_8c}{}\section{Node1/src/uart.c File Reference}
\label{Node1_2src_2uart_8c}\index{Node1/src/uart.\+c@{Node1/src/uart.\+c}}
{\ttfamily \#include \char`\"{}global\+\_\+declarations.\+h\char`\"{}}\\*
{\ttfamily \#include $<$avr/io.\+h$>$}\\*
{\ttfamily \#include $<$avr/interrupt.\+h$>$}\\*
{\ttfamily \#include $<$stdio.\+h$>$}\\*
{\ttfamily \#include $<$stdlib.\+h$>$}\\*
{\ttfamily \#include $<$string.\+h$>$}\\*
{\ttfamily \#include \char`\"{}uart.\+h\char`\"{}}\\*
Include dependency graph for uart.\+c\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{Node1_2src_2uart_8c__incl}
\end{center}
\end{figure}
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define {\bfseries B\+A\+UD}~9600\+U\+L 	/$\ast$! B\+A\+U\+D rate of U\+A\+R\+T$\ast$/\hypertarget{Node1_2src_2uart_8c_a62634036639f88eece6fbf226b45f84b}{}\label{Node1_2src_2uart_8c_a62634036639f88eece6fbf226b45f84b}

\item 
\#define {\bfseries B\+U\+F\+F\+E\+R\+\_\+\+M\+AX}~128 	/$\ast$! Size of Rx buffer$\ast$/\hypertarget{Node1_2src_2uart_8c_a65c660282414eff7e990f21f6b306cb8}{}\label{Node1_2src_2uart_8c_a65c660282414eff7e990f21f6b306cb8}

\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{Node1_2src_2uart_8c_a9622edb266a65452131cdbbccb5e5b0e}{I\+SR} (U\+S\+A\+R\+T0\+\_\+\+R\+X\+C\+\_\+vect)
\begin{DoxyCompactList}\small\item\em Interrupt vector for Rx. Place recieved data into buffer. \end{DoxyCompactList}\item 
\hyperlink{Node1_2src_2uart_8c_ae386730179b92f3cd381054196cc0751}{I\+SR} (U\+S\+A\+R\+T0\+\_\+\+T\+X\+C\+\_\+vect)
\item 
void \hyperlink{Node1_2src_2uart_8c_a01f5996cfbcef121abc486e732b208c7}{uart\+\_\+init} ()
\begin{DoxyCompactList}\small\item\em Initialize uart. \end{DoxyCompactList}\item 
int \hyperlink{Node1_2src_2uart_8c_a3997eef358f90d23280d1108a32d85e7}{uart\+\_\+send} (unsigned char msg)
\begin{DoxyCompactList}\small\item\em Busy wait transmission of msg. \end{DoxyCompactList}\item 
unsigned char \hyperlink{Node1_2src_2uart_8c_a1127aebe7441e1cc25f738127c53c4a3}{uart\+\_\+recv} ()
\begin{DoxyCompactList}\small\item\em Read data from buffer. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
F\+I\+LE \hyperlink{Node1_2src_2uart_8c_af7b899691fa46afc4d24937667462b08}{uart\+\_\+out} = F\+D\+E\+V\+\_\+\+S\+E\+T\+U\+P\+\_\+\+S\+T\+R\+E\+AM(\hyperlink{Node1_2src_2uart_8h_a3997eef358f90d23280d1108a32d85e7}{uart\+\_\+send}, N\+U\+LL, \+\_\+\+F\+D\+E\+V\+\_\+\+S\+E\+T\+U\+P\+\_\+\+W\+R\+I\+TE)
\begin{DoxyCompactList}\small\item\em Enable use of fprintf(\&uart\+\_\+out,...) for. \end{DoxyCompactList}\item 
F\+I\+LE \hyperlink{Node1_2src_2uart_8c_a40f1986412d89052918098aaf10377e5}{uart\+\_\+in} = F\+D\+E\+V\+\_\+\+S\+E\+T\+U\+P\+\_\+\+S\+T\+R\+E\+AM(N\+U\+LL, \hyperlink{Node1_2src_2uart_8h_a1127aebe7441e1cc25f738127c53c4a3}{uart\+\_\+recv}, \+\_\+\+F\+D\+E\+V\+\_\+\+S\+E\+T\+U\+P\+\_\+\+R\+E\+AD)\hypertarget{Node1_2src_2uart_8c_a40f1986412d89052918098aaf10377e5}{}\label{Node1_2src_2uart_8c_a40f1986412d89052918098aaf10377e5}

\begin{DoxyCompactList}\small\item\em Create input stream for uart. Unused. \end{DoxyCompactList}\item 
volatile char {\bfseries recv\+\_\+buffer} \mbox{[}B\+U\+F\+F\+E\+R\+\_\+\+M\+AX\mbox{]}\hypertarget{Node1_2src_2uart_8c_a2fa9595c8e9f9ba1955e5a427845ea4f}{}\label{Node1_2src_2uart_8c_a2fa9595c8e9f9ba1955e5a427845ea4f}

\item 
volatile int \hyperlink{Node1_2src_2uart_8c_aa4b36744e9b33682a6c02c5463ba28cf}{recvhead} = 0
\item 
volatile int \hyperlink{Node1_2src_2uart_8c_a3220abd95746b723680be6bc93ab26f7}{recvtail} = 0
\end{DoxyCompactItemize}


\subsection{Function Documentation}
\index{Node1/src/uart.\+c@{Node1/src/uart.\+c}!I\+SR@{I\+SR}}
\index{I\+SR@{I\+SR}!Node1/src/uart.\+c@{Node1/src/uart.\+c}}
\subsubsection[{\texorpdfstring{I\+S\+R(\+U\+S\+A\+R\+T0\+\_\+\+R\+X\+C\+\_\+vect)}{ISR(USART0_RXC_vect)}}]{\setlength{\rightskip}{0pt plus 5cm}I\+SR (
\begin{DoxyParamCaption}
\item[{U\+S\+A\+R\+T0\+\_\+\+R\+X\+C\+\_\+vect}]{}
\end{DoxyParamCaption}
)}\hypertarget{Node1_2src_2uart_8c_a9622edb266a65452131cdbbccb5e5b0e}{}\label{Node1_2src_2uart_8c_a9622edb266a65452131cdbbccb5e5b0e}


Interrupt vector for Rx. Place recieved data into buffer. 

Tail of buffer. Where next read will occour. \index{Node1/src/uart.\+c@{Node1/src/uart.\+c}!I\+SR@{I\+SR}}
\index{I\+SR@{I\+SR}!Node1/src/uart.\+c@{Node1/src/uart.\+c}}
\subsubsection[{\texorpdfstring{I\+S\+R(\+U\+S\+A\+R\+T0\+\_\+\+T\+X\+C\+\_\+vect)}{ISR(USART0_TXC_vect)}}]{\setlength{\rightskip}{0pt plus 5cm}I\+SR (
\begin{DoxyParamCaption}
\item[{U\+S\+A\+R\+T0\+\_\+\+T\+X\+C\+\_\+vect}]{}
\end{DoxyParamCaption}
)}\hypertarget{Node1_2src_2uart_8c_ae386730179b92f3cd381054196cc0751}{}\label{Node1_2src_2uart_8c_ae386730179b92f3cd381054196cc0751}
\begin{DoxyRefDesc}{Todo}
\item[\hyperlink{todo__todo000001}{Todo}]remove interrupt from Tx \end{DoxyRefDesc}
\index{Node1/src/uart.\+c@{Node1/src/uart.\+c}!uart\+\_\+init@{uart\+\_\+init}}
\index{uart\+\_\+init@{uart\+\_\+init}!Node1/src/uart.\+c@{Node1/src/uart.\+c}}
\subsubsection[{\texorpdfstring{uart\+\_\+init()}{uart_init()}}]{\setlength{\rightskip}{0pt plus 5cm}void uart\+\_\+init (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\hypertarget{Node1_2src_2uart_8c_a01f5996cfbcef121abc486e732b208c7}{}\label{Node1_2src_2uart_8c_a01f5996cfbcef121abc486e732b208c7}


Initialize uart. 

Initialize U\+A\+RT. \index{Node1/src/uart.\+c@{Node1/src/uart.\+c}!uart\+\_\+recv@{uart\+\_\+recv}}
\index{uart\+\_\+recv@{uart\+\_\+recv}!Node1/src/uart.\+c@{Node1/src/uart.\+c}}
\subsubsection[{\texorpdfstring{uart\+\_\+recv()}{uart_recv()}}]{\setlength{\rightskip}{0pt plus 5cm}unsigned char uart\+\_\+recv (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\hypertarget{Node1_2src_2uart_8c_a1127aebe7441e1cc25f738127c53c4a3}{}\label{Node1_2src_2uart_8c_a1127aebe7441e1cc25f738127c53c4a3}


Read data from buffer. 

Read one byte from the Rx buffer. Return zero if buffer is empty. 
\begin{DoxyRetVals}{Return values}
{\em } & \\
\hline
\end{DoxyRetVals}
\index{Node1/src/uart.\+c@{Node1/src/uart.\+c}!uart\+\_\+send@{uart\+\_\+send}}
\index{uart\+\_\+send@{uart\+\_\+send}!Node1/src/uart.\+c@{Node1/src/uart.\+c}}
\subsubsection[{\texorpdfstring{uart\+\_\+send(unsigned char msg)}{uart_send(unsigned char msg)}}]{\setlength{\rightskip}{0pt plus 5cm}int uart\+\_\+send (
\begin{DoxyParamCaption}
\item[{unsigned char}]{msg}
\end{DoxyParamCaption}
)}\hypertarget{Node1_2src_2uart_8c_a3997eef358f90d23280d1108a32d85e7}{}\label{Node1_2src_2uart_8c_a3997eef358f90d23280d1108a32d85e7}


Busy wait transmission of msg. 

Send data 
\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em msg} & one byte of data to send \\
\hline
\end{DoxyParams}

\begin{DoxyRetVals}{Return values}
{\em 0} & always. \\
\hline
\end{DoxyRetVals}


\subsection{Variable Documentation}
\index{Node1/src/uart.\+c@{Node1/src/uart.\+c}!recvhead@{recvhead}}
\index{recvhead@{recvhead}!Node1/src/uart.\+c@{Node1/src/uart.\+c}}
\subsubsection[{\texorpdfstring{recvhead}{recvhead}}]{\setlength{\rightskip}{0pt plus 5cm}volatile int recvhead = 0}\hypertarget{Node1_2src_2uart_8c_aa4b36744e9b33682a6c02c5463ba28cf}{}\label{Node1_2src_2uart_8c_aa4b36744e9b33682a6c02c5463ba28cf}
Buffer for storing recieved data \index{Node1/src/uart.\+c@{Node1/src/uart.\+c}!recvtail@{recvtail}}
\index{recvtail@{recvtail}!Node1/src/uart.\+c@{Node1/src/uart.\+c}}
\subsubsection[{\texorpdfstring{recvtail}{recvtail}}]{\setlength{\rightskip}{0pt plus 5cm}volatile int recvtail = 0}\hypertarget{Node1_2src_2uart_8c_a3220abd95746b723680be6bc93ab26f7}{}\label{Node1_2src_2uart_8c_a3220abd95746b723680be6bc93ab26f7}
Head of buffer. Where next recieved byte will be placed. \index{Node1/src/uart.\+c@{Node1/src/uart.\+c}!uart\+\_\+out@{uart\+\_\+out}}
\index{uart\+\_\+out@{uart\+\_\+out}!Node1/src/uart.\+c@{Node1/src/uart.\+c}}
\subsubsection[{\texorpdfstring{uart\+\_\+out}{uart_out}}]{\setlength{\rightskip}{0pt plus 5cm}F\+I\+LE uart\+\_\+out = F\+D\+E\+V\+\_\+\+S\+E\+T\+U\+P\+\_\+\+S\+T\+R\+E\+AM({\bf uart\+\_\+send}, N\+U\+LL, \+\_\+\+F\+D\+E\+V\+\_\+\+S\+E\+T\+U\+P\+\_\+\+W\+R\+I\+TE)}\hypertarget{Node1_2src_2uart_8c_af7b899691fa46afc4d24937667462b08}{}\label{Node1_2src_2uart_8c_af7b899691fa46afc4d24937667462b08}


Enable use of fprintf(\&uart\+\_\+out,...) for. 

U\+A\+RT implementation for atmega162 Hardcoded to use 9600 buad 8n1 = 8 data-\/bits, no parity, 1 stop bit Uses interrupts for recieving and busy wait for sending. Recieved messages go into an internal buffer untill mcu request them.\begin{DoxyRefDesc}{Todo}
\item[\hyperlink{todo__todo000002}{Todo}]\{change to use uint8\+\_\+t where it makes sense\} 

\{implement \char`\"{}buffer full\char`\"{} function\} \end{DoxyRefDesc}
